<!DOCTYPE html>
<html>
	<head>
		<title>Welcome</title>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
		<link rel="stylesheet" href="./css/main.css">
		<link rel="stylesheet" href="./css/tweet.css" />
		<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@48,300,0,0" />
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
		<!--Referencing Google charts-->
		<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
		<!--Referencing Google icons page for setting icon-->
		<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0" />
		<!--Referencing Google icons page for menu icon-->
		<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0" />
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<script type="text/javascript" src="jquery-1.5.min.js"></script>
		
		<script type="text/javascript">			
			let emotionHappiness = '<%-emotionHappiness%>';
			let HappinessDisplay = '<%-HappinessDisplay%>';
			let HappDisplay = JSON.parse(HappinessDisplay);
			let emotionAnger = '<%-emotionAnger%>';
			let emotionNeutral = '<%-emotionNeutral%>';
			let emotionDepression = '<%-emotionDepression%>';
			let emotionAnxiety = '<%-emotionAnxiety%>';
			let month = '<%-month%>';
			console.log(emotionHappiness);
			//Creating the donut chart:
			google.charts.load("current", {packages:["corechart"]});
			google.charts.setOnLoadCallback(drawDonutChart);
			function drawDonutChart() {
				var data = google.visualization.arrayToDataTable([
					['Emotion', 'Score'],
					['Happiness', Number(emotionHappiness)],
					['Depression', Number(emotionDepression)],
					['Anger', Number(emotionAnger)],
					['Anxiety', Number(emotionAnxiety)],
					['Neutral',	Number(emotionNeutral)]
				]);

				var options = {
				title: 'Emotion Score Based on Tweets',
				pieHole: 0.4,
				backgroundColor: 'transparent',
				slices: {
					0: { color: 'gold' },
					1: { color: 'blue' },
					2: { color: 'red' },
					3: { color: 'purple' },
					4: { color: 'green' }
				}
				};
				var chart = new google.visualization.PieChart(document.getElementById('donut_chart'));
				chart.draw(data, options);
				// var temp = "";
				// for (var i = 0; i < emotionHappiness; i++) {
				// 	temp += HappDisplay[i].Tweet;
				// }
				// document.getElementById("test").innerHTML = temp;
				document.getElementById("tweet_date").innerHTML = HappDisplay[0].Date;
				document.getElementById("tweet_emotion").innerHTML = HappDisplay[0].Emotion;
				document.getElementById("tweet_emotionValue").innerHTML = HappDisplay[0].Value;
				document.getElementById("tweet_content").innerHTML = HappDisplay[0].Tweet;
			}
			function getMonth(){
				document.getElementById("donut_select").value = month;
			}
		</script>
	</head>
	<body onload="getMonth()">
			<div class="banner" id="banner">
				<div class="banner_content">
					<!--Twitter Profile Image-->
					<div class="banner_profile">
						<img class="profile_image" src="loginLogo.png" alt="Profile Picture" style="width:50px;height:50px;">
					</div>
					<!--Twitter Username-->
					<div class="banner_text">
						<p class="username">@<%= name %></p>
						<!--Settings icon-->
						<span class="material-symbols-outlined" style="margin-left:1250px;">menu</span>
						<!--Settings icon-->
						<span class="material-symbols-outlined">settings</span>
			
				</div>
				</div>
			</div>
			<table>	
				<div id="donut_chart" style="width: 700px; height: 500px;"></div>
				<p>Sort by:</p>
				<td>
					<center>
						<form id="monthSelection" action="/monthSelection" method="post">
							<select id="donut_select" class="donut_select" name="donut_select">
								<option value="01">January</option>
								<option value="02">February</option>
								<option value="03">March</option>
								<option value="04">April</option>
								<option value="05">May</option>
								<option value="06">June</option>
								<option value="07">July</option>
								<option value="08">August</option>
								<option value="09">September</option>
								<option value="10">October</option>
								<option value="11">November</option>
								<option value="12">December</option>
							</select>
							<input type="submit" name="submit"/>
						</form>
					</center>
				</td>
			</table>
			<div class="layout">
				<div class="layout__main">
				  <div class="tweet">
					<div class="tweet__main">
						<div class="tweet__header">
							<div class="tweet_date" id="tweet_date"></div>
							<div class="tweet_emotion" id="tweet_emotion"></div>
							<div class="tweet_emotionValue" id="tweet_emotionValue"></div>
						</div>
						<div class="tweet_content" id="tweet_content"></div>
					</div>
				</div>
			</div>
			<div class="abc">
				<a href="/logout">Logout</a>
			</div>
			<form class="user-card-form" id="getTwitterID" method="post" action="/update">
				<button type="submit" value="update" id="update">Update</button>
			</form>
			<p id="test"></p>
		</div>
	</body>
</html>